outline.color = "gray",
ggtheme = ggplot2::theme_bw())
health_outcomes = mental_health %>%
select(-c(fips, state, name)) %>%
select(physically_unhealthy_days,
life_expectancy, perc_diabetic)
ggcorrplot(cor(health_outcomes),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = FALSE,
ggtheme = ggplot2::theme_bw())
# load libraries
library(kableExtra)                     # for printing tables
library(cowplot)                        # for side by side plots
library(lubridate)                      # for dealing with dates
library(maps)                           # for creating maps
library(tidyverse)
library(ggcorrplot)
# read in the cleaned data
mental_health = read_csv("data/clean/mental_health_clean.csv")
View(mental_health)
health_outcomes = mental_health %>%
select(-c(fips, state, name)) %>%
select(physically_unhealthy_days,
life_expectancy, perc_diabetic)
p4 = ggcorrplot(cor(health_outcomes),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = FALSE,
ggtheme = ggplot2::theme_bw())
ggsave(filename = "results/response-health_outcomes.png",
plot = p4,
device = "png",
width = 5,
height = 3)
p8 = ggcorrplot(cor(physical_environment),
colors = c("lightgreen", "white", "darkgreen"),
hc.order = TRUE,
type = "lower",
lab = FALSE,
outline.color = "gray",
ggtheme = ggplot2::theme_bw())
# load libraries
library(kableExtra)                     # for printing tables
library(cowplot)                        # for side by side plots
library(lubridate)                      # for dealing with dates
library(maps)                           # for creating maps
library(tidyverse)
# read in the cleaned data
mental_health = read_csv("data/clean/mental_health_clean.csv")
# create histogram of case fatality rate
# save the mean
mean <- mean(mental_health$mentally_unhealthy_days)
# plot mentally_unhealthy days and draw line at the mean
p = mental_health %>%
ggplot(aes(x = mentally_unhealthy_days)) +
geom_histogram() +
geom_vline(xintercept = mean,
linetype = "dashed",
col = "red") +
labs(x = "Mentally Unhealthy Days (per month)",
y = "Number of Counties") +
theme_bw()
# save the histogram
ggsave(filename = "results/response-histogram.png",
plot = p,
device = "png",
width = 5,
height = 3)
mental_health %>%
left_join(counties, by = "fips")
mental_health %>%
filter(state =="West Virginia") %>%
ggplot(mapping = aes(long, lat, group = group, fill = horate)) +
geom_polygon(color = "#ffffff", size = .25) +
scale_fill_gradientn(labels = scales::percent,
guide = guide_colorbar(title.position = "top")) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme(legend.title = element_text(),
legend.key.width = unit(.5, "in")) +
labs(fill = "mentally_unhealthy") +
theme_urban_map()
mental_health %>%
filter(state =="West Virginia") %>%
ggplot(mapping = aes(long, lat, group = group, fill = horate)) +
geom_polygon(color = "#ffffff", size = .25) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme(legend.title = element_text(),
legend.key.width = unit(.5, "in")) +
labs(fill = "mentally_unhealthy") +
theme_urban_map()
mental_health %>%
filter(state =="West Virginia") %>%
ggplot(mapping = aes(long, lat, group = group, fill = horate)) +
geom_polygon(color = "#ffffff", size = .25) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme(legend.title = element_text(),
legend.key.width = unit(.5, "in")) +
labs(fill = "mentally_unhealthy")
mental_health %>%
filter(state =="West Virginia") %>%
ggplot(mapping = aes(long, lat, group = group, fill = horate)) +
geom_polygon(color = "#ffffff", size = .25)
map_data("county") %>%
filter(state_name =="California") %>%
as_tibble() %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
p2 = map_data("county") %>%
as_tibble() %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot()
p2
map_data("county") %>%
as_tibble() %>%
filter(region == "North Dakota") %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "North Dakota"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
map_data("county") %>%
as_tibble() %>%
filter(region == "North Dakota") %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "North Dakota"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
library(maps)                           # for creating maps
map_data("county") %>%
as_tibble() %>%
filter(region == "North Dakota") %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "North Dakota"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename( subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename( subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(subregion == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
fill = "dodgerblue",
color="black", size = .25) +
theme_void()
View(mental_health)
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("name"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("subregion"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("name"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("subregion"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("name"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "pennsylvania") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "pennsylvania"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "West Virginia") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "West Virginia"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "west virginia") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "west virginia"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "north dakota") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "north dakota"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
# create a map of Florida
map_data("county") %>%
as_tibble() %>%
filter(region == "west virginia") %>%
left_join(mental_health %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state") %>% filter(region == "west virginia"),
aes(x=long, y=lat, group=group),
color="black", fill=NA, size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "blue", high = "red") +
theme_void()
