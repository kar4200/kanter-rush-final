# create a heatmap of mentally unhealthy days for cleaned dataset (this is just showing what the data looks like)
p2 = map_data("county") %>%
as_tibble() %>%
left_join(mental_health_clean %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "#afd0a9", high = "#800000") +
theme_void() +
ggtitle("Heat Map - Cleaned Dataset")
# load libraries
library(kableExtra)                     # for printing tables
library(cowplot)                        # for side by side plots
library(lubridate)                      # for dealing with dates
library(maps)                           # for creating maps
library(tidyverse)
# read in the cleaned data
mental_health_clean = read_csv("data/clean/mental_health_clean.csv")
health_total = read_csv("data/clean/health_data_clean.csv")
setwd("~/Desktop/stat-471-fall-2021/kanter-rush-final")
# read in the cleaned data
mental_health_clean = read_csv("data/clean/mental_health_clean.csv")
health_total = read_csv("data/clean/health_data_clean.csv")
# create histogram of mentally unhealthy days in dataset
mean <- mean(mental_health_clean$mentally_unhealthy_days) # save the mean
cutoff <- 4.5 # save the cutoff
# load libraries
library(kableExtra)                     # for printing tables
library(cowplot)                        # for side by side plots
library(lubridate)                      # for dealing with dates
library(maps)                           # for creating maps
library(tidyverse)
# read in the cleaned data
mental_health_clean = read_csv("data/clean/mental_health_clean.csv")
health_total = read_csv("data/clean/health_data_clean.csv")
# create histogram of mentally unhealthy days in dataset
mean <- mean(mental_health_clean$mentally_unhealthy_days) # save the mean
cutoff <- 4.5 # save the cutoff
# plot mentally_unhealthy days and draw line at the mean
p = mental_health_clean %>%
ggplot(aes(x = mentally_unhealthy_days)) +
geom_histogram(fill = "light grey",
col = "black") +
geom_vline(xintercept = mean,
linetype = "dashed",
col = "red") +
geom_vline(xintercept = cutoff,
linetype = "dashed",
col = "blue") +
labs(x = "Mentally Unhealthy Days (Per Month)",
y = "Number of Counties") +
theme_bw() +
ggtitle("Histogram of Mentally Unhealthy Days")
# save the histogram
ggsave(filename = "results/response-histogram.png",
plot = p,
device = "png",
width = 5,
height = 3)
# create a heatmap of mentally unhealthy days for cleaned dataset (this is just showing what the data looks like)
p2 = map_data("county") %>%
as_tibble() %>%
left_join(mental_health_clean %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "#7a9f79", high = "#800000") +
theme_void() +
ggtitle("Heat Map - Cleaned Dataset")
p2
# create a heatmap of mentally unhealthy days for cleaned dataset (this is just showing what the data looks like)
p2 = map_data("county") %>%
as_tibble() %>%
left_join(mental_health_clean %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "#7a9f79", high = "#FFFFFFF") +
theme_void() +
ggtitle("Heat Map - Cleaned Dataset")
source('~/Desktop/stat-471-fall-2021/kanter-rush-final/code/2-exploration-response.R', echo=TRUE)
# create a heatmap of mentally unhealthy days for cleaned dataset (this is just showing what the data looks like)
p2 = map_data("county") %>%
as_tibble() %>%
left_join(mental_health_clean %>%
rename(region = state,
subregion = name,
`Mentally Unhealthy Days` = mentally_unhealthy_days) %>%
mutate(region = str_to_lower(region),
subregion = str_to_lower(subregion)),
by = c("region", "subregion")) %>%
ggplot() +
geom_polygon(data=map_data("state"),
aes(x=long, y=lat, group=group),
color="black", fill=NA,  size = 1, alpha = .3) +
geom_polygon(aes(x=long, y=lat, group=group, fill = `Mentally Unhealthy Days`),
color="darkblue", size = .1) +
scale_fill_gradient(low = "#7a9f79", high = "#FFFFFF") +
theme_void() +
ggtitle("Heat Map - Cleaned Dataset")
p2
