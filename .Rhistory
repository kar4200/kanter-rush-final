# read in the cleaned data
mental_health_clean = read_csv("data/clean/mental_health_clean.csv")
# load libraries
library(kableExtra)                     # for printing tables
library(cowplot)                        # for side by side plots
library(lubridate)                      # for dealing with dates
library(maps)                           # for creating maps
library(tidyverse)
setwd("~/Desktop/stat-471-fall-2021/kanter-rush-final")
# read in the cleaned data
mental_health_clean = read_csv("data/clean/mental_health_clean.csv")
View(mental_health_clean)
# read in training data
mental_health_train = read_csv("data/clean/mental_health_train.csv")
# load libraries
library(tidyverse)
library(ggcorrplot)
# read in the cleaned data
mental_health_clean = read_csv("data/clean/mental_health_clean.csv")
# read in training data
mental_health_train = read_csv("data/clean/mental_health_train.csv")
# correlated features - health_outcomes
health_outcomes = mental_health_train %>%
select(physically_unhealthy_days,
life_expectancy, perc_diabetic)
ggcorrplot(cor(health_outcomes),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 4,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Health Outcomes")
p4 = ggcorrplot(cor(health_outcomes),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 4,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Health Outcomes")
ggsave(filename = "results/corr-health_outcomes.png",
plot = p4,
device = "png",
width = 5,
height = 5)
# correlated features - health-behavior
health_behavior = mental_health_train %>%
select(perc_smokers, perc_obese,
perc_physically_inactive,
perc_excessive_drinking,
chlamydia_rate, teen_birth_rate,
perc_insufficient_sleep, perc_food_insecure)
ggcorrplot(cor(health_behavior),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 2,
tl.cex = 7,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Health Behavior")
p5 = ggcorrplot(cor(health_behavior),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 2,
tl.cex = 7,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Health Behavior")
ggsave(filename = "results/corr-health_behavior.png",
plot = p5,
device = "png",
width = 5,
height = 5)
# correlated features - clinical care
clinical_care = mental_health_train %>%
select(perc_uninsured, pcp_rate, dentist_rate,
mhp_rate, prevent_hosp_rate,
perc_mammography_screened, perc_flu_vaccinated)
p6 = ggcorrplot(cor(clinical_care),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 3,
tl.cex = 8,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Clinical Care")
ggsave(filename = "results/corr-clinical-care.png",
plot = p6,
device = "png",
width = 5,
height = 5)
# correlated features - social_environment
social_economic_environment = mental_health_train %>%
select(graduation_rate, perc_some_college,
perc_unemployed, perc_children_in_poverty,
perc_single_parent_households,
association_rate, violent_crime_rate,
injury_death_rate, household_income,
perc_free_or_reduced_lunch, perc_homeowners,
household_has_broadband,
household_has_computer, household_has_smartphone,
housing_mobile_homes, per_capita_income,
persons_per_household, income_ratio,
perc_with_access, perc_limited_access, food_environment_index)
ggcorrplot(cor(social_economic_environment),
hc.order = FALSE,
type = "lower",
lab = TRUE,
lab_size = 1.5,
tl.cex = 6.5,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Social + Economic Environment")
p7 = ggcorrplot(cor(social_economic_environment),
hc.order = FALSE,
type = "lower",
lab = TRUE,
lab_size = 1.5,
tl.cex = 6.5,
ggtheme = ggplot2::theme_bw()) +
ggtitle("Social and Economic Environment")
ggsave(filename = "results/corr-social-economic-environment.png",
plot = p7,
device = "png",
width = 6,
height = 6)
physical_environment = mental_health_train %>%
select(average_daily_pm2.5, presence_of_violation, perc_severe_housing_cost_burden,
perc_severe_housing_problems,
overcrowding, inadequate_facilities, perc_drive_alone,
perc_long_commute_drives_alone, perc_rural)
p8 = ggcorrplot(cor(physical_environment),
colors = c("blue", "white", "red"),
hc.order = TRUE,
type = "lower",
lab = TRUE,
lab_size = 2,
tl.cex = 6.5,
outline.color = "gray",
ggtheme = ggplot2::theme_bw()) +
ggtitle("Physical Environment")
ggsave(filename = "results/corr-physical-environment.png",
plot = p8,
device = "png",
width = 5,
height = 5)
ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Physically Unhealthy Days vs. Mentally Unhealthy")
ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Figure 1: Physically Unhealthy Days vs. Mentally Unhealthy")
ggplot(data = mental_health_train,
aes(x = perc_smokers,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Percentage of adults that reported currently smoking", y = "Mentally Unhealthy") +
ggtitle("Figure 2: Smoking vs. Mentally Unhealthy")
# health outcomes
# physically unhealthy days
p9 = ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Figure 1: Physically Unhealthy Days vs. Mentally Unhealthy")
ggsave(filename = "results/physically_unhealthy_days.png",
plot = p9,
device = "png",
width = 3,
height = 3)
ggsave(filename = "results/physically_unhealthy_days.png",
plot = p9,
device = "png",
width = 5,
height = 5)
ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
geom+jitter() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Figure 1: Physically Unhealthy Days vs. Mentally Unhealthy")
ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
geom_jitter() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Figure 1: Physically Unhealthy Days vs. Mentally Unhealthy")
# health outcomes
# physically unhealthy days
p9 = ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Figure 1: Physically Unhealthy Days vs. Mentally Unhealthy")
ggsave(filename = "results/physically_unhealthy_days.png",
plot = p9,
device = "png",
width = 5,
height = 5)
# health behaviors
# smoking
p11 = ggplot(data = mental_health_train,
aes(x = perc_smokers,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Percentage of adults that reported currently smoking", y = "Mentally Unhealthy") +
ggtitle("Figure 2: Smoking vs. Mentally Unhealthy")
ggsave(filename = "results/smoking.png",
plot = p11,
device = "png",
width = 5,
height = 5)
# clinical care
# mhp rate
p13 = ggplot(data = mental_health_train,
aes(x = mhp_rate,
y = mentally_unhealthy)) +
geom_point() +
xlab("Mental Health Providers per 100,000 population") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 3: MHP Providers vs. Mentally Unhealthy")
ggsave(filename = "results/mhp_rate.png",
plot = p13,
device = "png",
width = 5,
height = 5)
# social / economic environment
# household income
p14 = ggplot(data = mental_health_train,
aes(x = household_income,
y = mentally_unhealthy)) +
geom_point() +
xlab("Household Income") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 4: Household Income vs. Mentally Unhealthy")
ggsave(filename = "results/household_income.png",
plot = p14,
device = "png",
width = 5,
height = 5)
# physical environment
# inadequate facilities
p16 = ggplot(data = mental_health_train,
aes(x = inadequate_facilities,
y = mentally_unhealthy)) +
geom_point() +
xlab("Percentage of households with lack of kitchen or plumbing facilities") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 5: Physical Environment vs. Mentally Unhealthy")
ggsave(filename = "results/inadequate_facilities.png",
plot = p16,
device = "png",
width = 5,
height = 5)
p17 = ggplot(data = mental_health_train,
aes(x = perc_excessive_drinking,
y = mentally_unhealthy)) +
geom_point() +
xlab("Percentage of adults that reported excessive drinking") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 6: Excessive Drinking vs. Mentally Unhealthy")
ggsave(filename = "results/excessive-drinking.png",
plot = p17,
device = "png",
width = 5,
height = 5)
# health outcomes
# physically unhealthy days
p9 = ggplot(data = mental_health_train,
aes(x = physically_unhealthy_days,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Physically Unhealthy Days", y = "Mentally Unhealthy") +
ggtitle("Figure 1: Physically Unhealthy Days")
ggsave(filename = "results/physically_unhealthy_days.png",
plot = p9,
device = "png",
width = 5,
height = 5)
# health behaviors
# smoking
p11 = ggplot(data = mental_health_train,
aes(x = perc_smokers,
y = mentally_unhealthy)) +
geom_point() +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
labs(x = "Percentage of adults that reported currently smoking", y = "Mentally Unhealthy") +
ggtitle("Figure 2: Smoking")
ggsave(filename = "results/smoking.png",
plot = p11,
device = "png",
width = 5,
height = 5)
# clinical care
# mhp rate
p13 = ggplot(data = mental_health_train,
aes(x = mhp_rate,
y = mentally_unhealthy)) +
geom_point() +
xlab("Mental Health Providers per 100,000 population") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 3: MHP Providers")
ggsave(filename = "results/mhp_rate.png",
plot = p13,
device = "png",
width = 5,
height = 5)
# social / economic environment
# household income
p14 = ggplot(data = mental_health_train,
aes(x = household_income,
y = mentally_unhealthy)) +
geom_point() +
xlab("Household Income") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 4: Household Income")
ggsave(filename = "results/household_income.png",
plot = p14,
device = "png",
width = 5,
height = 5)
# physical environment
# inadequate facilities
p16 = ggplot(data = mental_health_train,
aes(x = inadequate_facilities,
y = mentally_unhealthy)) +
geom_point() +
xlab("Percentage of households with lack of kitchen or plumbing facilities") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 5: Physical Environment")
ggsave(filename = "results/inadequate_facilities.png",
plot = p16,
device = "png",
width = 5,
height = 5)
p17 = ggplot(data = mental_health_train,
aes(x = perc_excessive_drinking,
y = mentally_unhealthy)) +
geom_point() +
xlab("Percentage of adults that reported excessive drinking") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 6: Excessive Drinking")
ggsave(filename = "results/excessive-drinking.png",
plot = p17,
device = "png",
width = 5,
height = 5)
# physical environment
# inadequate facilities
p16 = ggplot(data = mental_health_train,
aes(x = inadequate_facilities,
y = mentally_unhealthy)) +
geom_point() +
xlab("Percentage of households without kitchen or plumbing facilities") +
ylab("Mentally Unhealthy") +
stat_smooth(method="glm", se=FALSE,
method.args = list(family=binomial),
color = "red") +
theme_bw() +
ggtitle("Figure 5: Inadequate Household Facilities")
ggsave(filename = "results/inadequate_facilities.png",
plot = p16,
device = "png",
width = 5,
height = 5)
